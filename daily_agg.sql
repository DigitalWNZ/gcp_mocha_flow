--This script aggregate by day the events from users, who installed our apps in last N days.  
--Step 1: Run and validate the query below in bigquery 
--Step 2: Create a daily schedule job(aka: schedule_job_A) to write the query result to table_A which contains results from all execution of the schedule job 
 --so their will be duplicate records in table A, the dedup script is in dedup.sql. Save the name of table_A for usage in dedup.sql 
CREATE TEMP FUNCTION
abstract_params(input_arr Array<struct<key string, value struct<string_value string, int_value int64, float_value float64, double_value float64>>>, key_value string,value_field int64)
RETURNS int64
LANGUAGE js AS r"""
 ret=0
 var i=input_arr.length;
 while(i--){
     if (input_arr[i].key==key_value) {
         if (value_field == 1) {
             ret=input_arr[i].value.int_value;
             i=0;
         } else if (value_field == 2) {
             ret=input_arr[i].value.float_value;
             i=0
         } else {
             ret=input_arr[i].value.double_value;
             i=0
         }
     }
 };
 if (ret === "") { 
     return 0; 
 } else { 
     return ret; 
 } 
""";
with event_window as ( 
select current_date() as event_date union all 
select date_sub(current_date(), interval 1 day) union all 
select date_sub(current_date(), interval 2 day) union all 
select date_sub(current_date(), interval 3 day) union all 
select date_sub(current_date(), interval 4 day) union all 
select date_sub(current_date(), interval 5 day) union all 
select date_sub(current_date(), interval 6 day) union all 
select date_sub(current_date(), interval 7 day) union all 
select date_sub(current_date(), interval 8 day) union all 
select date_sub(current_date(), interval 9 day) union all 
select date_sub(current_date(), interval 10 day) union all 
select date_sub(current_date(), interval 11 day) union all 
select date_sub(current_date(), interval 12 day) union all 
select date_sub(current_date(), interval 13 day) union all 
select date_sub(current_date(), interval 14 day) union all 
select date_sub(current_date(), interval 15 day) union all 
select date_sub(current_date(), interval 16 day) union all 
select date_sub(current_date(), interval 17 day) union all 
select date_sub(current_date(), interval 18 day) union all 
select date_sub(current_date(), interval 19 day) union all 
select date_sub(current_date(), interval 20 day) union all 
select date_sub(current_date(), interval 21 day) union all 
select date_sub(current_date(), interval 22 day) union all 
select date_sub(current_date(), interval 23 day) union all 
select date_sub(current_date(), interval 24 day) union all 
select date_sub(current_date(), interval 25 day) union all 
select date_sub(current_date(), interval 26 day) union all 
select date_sub(current_date(), interval 27 day) union all 
select date_sub(current_date(), interval 28 day) union all 
select date_sub(current_date(), interval 29 day) union all 
select date_sub(current_date(), interval 30 day) union all 
select date_sub(current_date(), interval 31 day) union all 
select date_sub(current_date(), interval 32 day) union all 
select date_sub(current_date(), interval 33 day) union all 
select date_sub(current_date(), interval 34 day) union all 
select date_sub(current_date(), interval 35 day) union all 
select date_sub(current_date(), interval 36 day) union all 
select date_sub(current_date(), interval 37 day) union all 
select date_sub(current_date(), interval 38 day) union all 
select date_sub(current_date(), interval 39 day) union all 
select date_sub(current_date(), interval 40 day) union all 
select date_sub(current_date(), interval 41 day) union all 
select date_sub(current_date(), interval 42 day) union all 
select date_sub(current_date(), interval 43 day) union all 
select date_sub(current_date(), interval 44 day) union all 
select date_sub(current_date(), interval 45 day) union all 
select date_sub(current_date(), interval 46 day) union all 
select date_sub(current_date(), interval 47 day) union all 
select date_sub(current_date(), interval 48 day) union all 
select date_sub(current_date(), interval 49 day) union all 
select date_sub(current_date(), interval 50 day) union all 
select date_sub(current_date(), interval 51 day) union all 
select date_sub(current_date(), interval 52 day) union all 
select date_sub(current_date(), interval 53 day) union all 
select date_sub(current_date(), interval 54 day) union all 
select date_sub(current_date(), interval 55 day) union all 
select date_sub(current_date(), interval 56 day) union all 
select date_sub(current_date(), interval 57 day) union all 
select date_sub(current_date(), interval 58 day) union all 
select date_sub(current_date(), interval 59 day) union all 
select date_sub(current_date(), interval 60 day) 
), 
distinct_user_install_event as ( 
select 
user_id as universal_user_id, 
parse_date("%Y%m%d",safe_cast(event_date as string))  as install_date, 
count(0) 
from `pltv-310710.originaldata_by_day.zsgl_events` 
where parse_date("%Y%m%d",safe_cast(event_date as string))  >= date_sub(current_date(), interval 60 day) 
and event_name= 'role' 
group by 1,2), 
distinct_user_install_event_with_next as ( 
select 
universal_user_id,install_date, 
ifnull(lag(install_date) over (partition by universal_user_id order by install_date desc),date('9999-12-31')) as next_install_date, 
from distinct_user_install_event
), 
full_user_date as ( 
select 
a.universal_user_id, 
a.install_date, 
b.event_date 
from distinct_user_install_event_with_next a 
cross join event_window b 
where b.event_date >= a.install_date 
and b.event_date < a.next_install_date 
order by universal_user_id, event_date 
), 
data_flat_1 as ( 
select 
user_id as universal_user_id, 
event_name, 
parse_date("%Y%m%d",safe_cast(event_date as string))  as event_date, 
if (event_name in ('login','role'), 1 , 0) as login_flag, 
 if (event_name in ('pay') , 1 , 0) as pay_flag, 
if (event_name='_200056',1,0) as _200056__count,
if (event_name='_100211',1,0) as _100211__count,
if (event_name='_100062',1,0) as _100062__count,
if (event_name='_200036',1,0) as _200036__count,
if (event_name='_200190',1,0) as _200190__count,
if (event_name='_100577',1,0) as _100577__flag,
if (event_name='_200179',1,0) as _200179__flag,
if (event_name='_100023',1,0) as _100023__flag,
if (event_name='_200079',1,0) as _200079__flag,
if (event_name='_100537',1,0) as _100537__flag,
if (event_name='_200051',1,0) as _200051__flag,
if (event_name='_200218',1,0) as _200218__flag,
if (event_name='_200157',1,0) as _200157__flag,
if (event_name='_100031',1,0) as _100031__flag,
if (event_name='_100525',1,0) as _100525__count,
if (event_name='_100097',1,0) as _100097__count,
if (event_name='_200177',1,0) as _200177__flag,
if (event_name='_100194',1,0) as _100194__flag,
if (event_name='_200050',1,0) as _200050__flag,
if (event_name='_200122',1,0) as _200122__flag,
if (event_name='_200114',1,0) as _200114__flag,
if (event_name='_100547',1,0) as _100547__count,
if (event_name='_200037',1,0) as _200037__flag,
if (event_name='_100186',1,0) as _100186__count,
if (event_name='_200121',1,0) as _200121__flag,
if (event_name='_100109',1,0) as _100109__count,
if (event_name='_100521',1,0) as _100521__count,
if (event_name='_100566',1,0) as _100566__flag,
if (event_name='_200032',1,0) as _200032__flag,
if (event_name='_100099',1,0) as _100099__flag,
if (event_name='_100178',1,0) as _100178__count,
if (event_name='_100049',1,0) as _100049__flag,
if (event_name='_100578',1,0) as _100578__flag,
if (event_name='_200226',1,0) as _200226__flag,
if (event_name='_100004',1,0) as _100004__flag,
if (event_name='_200113',1,0) as _200113__flag,
if (event_name='_200033',1,0) as _200033__flag,
if (event_name='_100156',1,0) as _100156__count,
if (event_name='_200204',1,0) as _200204__flag,
if (event_name='_100199',1,0) as _100199__count,
if (event_name='_200024',1,0) as _200024__flag,
if (event_name='_100542',1,0) as _100542__flag,
if (event_name='_200144',1,0) as _200144__flag,
if (event_name='_200009',1,0) as _200009__flag,
if (event_name='_200101',1,0) as _200101__flag,
if (event_name='_100519',1,0) as _100519__flag,
if (event_name='_100069',1,0) as _100069__flag,
if (event_name='_100574',1,0) as _100574__count,
if (event_name='_100122',1,0) as _100122__flag,
if (event_name='_200105',1,0) as _200105__flag,
if (event_name='_100131',1,0) as _100131__flag,
if (event_name='_100022',1,0) as _100022__count,
if (event_name='_100588',1,0) as _100588__flag,
if (event_name='_200184',1,0) as _200184__flag,
if (event_name='pay', abstract_params(event_params,'pay_money',1) ,null) as pay__pay_money,
if (event_name='_100516',1,0) as _100516__count,
if (event_name='_100041',1,0) as _100041__count,
if (event_name='_200008',1,0) as _200008__flag,
if (event_name='_200108',1,0) as _200108__flag,
if (event_name='_100217',1,0) as _100217__flag,
if (event_name='_200064',1,0) as _200064__flag,
if (event_name='_100539',1,0) as _100539__flag,
if (event_name='_100159',1,0) as _100159__count,
if (event_name='_100101',1,0) as _100101__count,
if (event_name='_100236',1,0) as _100236__count,
if (event_name='_100080',1,0) as _100080__count,
if (event_name='_100193',1,0) as _100193__flag,
if (event_name='_100116',1,0) as _100116__flag,
if (event_name='_100137',1,0) as _100137__count,
if (event_name='_100514',1,0) as _100514__count,
if (event_name='_200147',1,0) as _200147__flag,
if (event_name='_100226',1,0) as _100226__flag,
if (event_name='_100546',1,0) as _100546__count,
if (event_name='_100138',1,0) as _100138__count,
if (event_name='_100184',1,0) as _100184__count,
if (event_name='_100013',1,0) as _100013__count,
if (event_name='_100218',1,0) as _100218__count,
if (event_name='_100153',1,0) as _100153__count,
if (event_name='_100020',1,0) as _100020__flag,
if (event_name='_100070',1,0) as _100070__count,
if (event_name='_100557',1,0) as _100557__flag,
if (event_name='_200176',1,0) as _200176__count,
if (event_name='_100065',1,0) as _100065__count,
if (event_name='_200216',1,0) as _200216__flag,
if (event_name='_200145',1,0) as _200145__flag,
if (event_name='_200092',1,0) as _200092__flag,
if (event_name='_100212',1,0) as _100212__count,
if (event_name='_100054',1,0) as _100054__count,
if (event_name='_200030',1,0) as _200030__count,
if (event_name='_200158',1,0) as _200158__flag,
if (event_name='_100202',1,0) as _100202__flag,
if (event_name='_100161',1,0) as _100161__flag,
if (event_name='_200016',1,0) as _200016__flag,
if (event_name='_200149',1,0) as _200149__flag,
if (event_name='_100572',1,0) as _100572__count,
if (event_name='_100162',1,0) as _100162__count,
if (event_name='_100072',1,0) as _100072__count,
if (event_name='_200106',1,0) as _200106__flag,
if (event_name='_200117',1,0) as _200117__flag,
if (event_name='_200038',1,0) as _200038__flag,
if (event_name='_200214',1,0) as _200214__flag,
if (event_name='_200152',1,0) as _200152__flag,
if (event_name='_200168',1,0) as _200168__flag,
if (event_name='_200007',1,0) as _200007__count,
if (event_name='_200189',1,0) as _200189__count,
if (event_name='_100569',1,0) as _100569__count,
if (event_name='_100214',1,0) as _100214__count,
if (event_name='_100012',1,0) as _100012__count,
if (event_name='_100544',1,0) as _100544__count,
if (event_name='_100142',1,0) as _100142__flag,
if (event_name='_200072',1,0) as _200072__flag,
if (event_name='_100148',1,0) as _100148__count,
if (event_name='_100564',1,0) as _100564__count,
if (event_name='_200091',1,0) as _200091__flag,
if (event_name='_100043',1,0) as _100043__count,
if (event_name='_200095',1,0) as _200095__count,
if (event_name='_200151',1,0) as _200151__count,
if (event_name='_100209',1,0) as _100209__count,
if (event_name='_200097',1,0) as _200097__count,
if (event_name='_200213',1,0) as _200213__count,
if (event_name='_100034',1,0) as _100034__count,
if (event_name='_200058',1,0) as _200058__count,
if (event_name='_200155',1,0) as _200155__count,
if (event_name='_100533',1,0) as _100533__count,
if (event_name='_100589',1,0) as _100589__count,
if (event_name='_200019',1,0) as _200019__flag,
if (event_name='_200187',1,0) as _200187__count,
if (event_name='_200215',1,0) as _200215__flag,
if (event_name='_100575',1,0) as _100575__count,
if (event_name='_200178',1,0) as _200178__count,
if (event_name='_100026',1,0) as _100026__count,
if (event_name='_200109',1,0) as _200109__count,
if (event_name='_100548',1,0) as _100548__count,
if (event_name='_100117',1,0) as _100117__flag,
if (event_name='_100092',1,0) as _100092__count,
if (event_name='_100170',1,0) as _100170__count,
if (event_name='_100180',1,0) as _100180__count,
if (event_name='_100086',1,0) as _100086__flag,
if (event_name='_100106', abstract_params(event_params,'item_number',1) ,null) as _100106__item_number,
if (event_name='_200055',1,0) as _200055__flag,
if (event_name='_200167',1,0) as _200167__count,
if (event_name='_200220', abstract_params(event_params,'item_number',1) ,null) as _200220__item_number,
if (event_name='_100213',1,0) as _100213__flag,
if (event_name='_100565',1,0) as _100565__count,
if (event_name='_200219',1,0) as _200219__count,
if (event_name='_200223',1,0) as _200223__count,
if (event_name='_100112',1,0) as _100112__flag,
if (event_name='_200217',1,0) as _200217__count,
if (event_name='_100520',1,0) as _100520__count,
if (event_name='_200115',1,0) as _200115__count,
if (event_name='_200186',1,0) as _200186__count,
if (event_name='_100029',1,0) as _100029__count,
if (event_name='_200067',1,0) as _200067__count,
if (event_name='_100540',1,0) as _100540__count,
if (event_name='_100090',1,0) as _100090__count,
if (event_name='_200002',1,0) as _200002__count,
if (event_name='_100052',1,0) as _100052__count,
if (event_name='_100061',1,0) as _100061__count,
if (event_name='_100017',1,0) as _100017__flag,
if (event_name='_200169',1,0) as _200169__flag,
if (event_name='_100037',1,0) as _100037__count,
if (event_name='_100110',1,0) as _100110__flag,
if (event_name='_100154',1,0) as _100154__flag,
if (event_name='_200224',1,0) as _200224__flag,
if (event_name='_100586',1,0) as _100586__flag,
if (event_name='_200111',1,0) as _200111__flag,
if (event_name='_200021',1,0) as _200021__flag,
if (event_name='_100536',1,0) as _100536__count,
if (event_name='_100055', abstract_params(event_params,'item_number',1) ,null) as _100055__item_number,
if (event_name='_200146',1,0) as _200146__flag,
if (event_name='_100018',1,0) as _100018__flag,
if (event_name='_100168',1,0) as _100168__flag,
if (event_name='_100007',1,0) as _100007__flag,
if (event_name='_200069',1,0) as _200069__flag,
if (event_name='_100563',1,0) as _100563__flag,
if (event_name='_100513',1,0) as _100513__flag,
if (event_name='_100060', abstract_params(event_params,'item_number',1) ,null) as _100060__item_number,
if (event_name='_100130',1,0) as _100130__flag,
if (event_name='_100568',1,0) as _100568__count,
if (event_name='_100128',1,0) as _100128__flag,
if (event_name='_100024', abstract_params(event_params,'item_number',1) ,null) as _100024__item_number,
if (event_name='_100064',1,0) as _100064__flag,
if (event_name='_100538',1,0) as _100538__flag,
if (event_name='_100093', abstract_params(event_params,'item_number',1) ,null) as _100093__item_number,
if (event_name='_200161',1,0) as _200161__flag,
if (event_name='_100095',1,0) as _100095__flag,
if (event_name='_100166',1,0) as _100166__count,
if (event_name='_200212',1,0) as _200212__count,
if (event_name='gold', abstract_params(event_params,'amount',1) ,null) as gold__amount,
if (event_name='_200013',1,0) as _200013__flag,
if (event_name='_200100',1,0) as _200100__flag,
if (event_name='_200004',1,0) as _200004__flag,
if (event_name='_100592',1,0) as _100592__count,
if (event_name='_100140',1,0) as _100140__flag,
if (event_name='_100019',1,0) as _100019__flag,
if (event_name='_100053',1,0) as _100053__flag,
if (event_name='_100515',1,0) as _100515__flag,
if (event_name='_200107',1,0) as _200107__flag,
if (event_name='_100155',1,0) as _100155__flag,
if (event_name='_100169',1,0) as _100169__flag,
if (event_name='_200077',1,0) as _200077__count,
if (event_name='_200081',1,0) as _200081__count,
if (event_name='_100063', abstract_params(event_params,'item_number',1) ,null) as _100063__item_number,
if (event_name='_200010',1,0) as _200010__flag,
if (event_name='_100245',1,0) as _100245__count,
if (event_name='quit',1,0) as quit__flag,
if (event_name='_200006',1,0) as _200006__flag,
if (event_name='_200063',1,0) as _200063__flag,
if (event_name='_200046',1,0) as _200046__flag,
if (event_name='_100145',1,0) as _100145__flag,
if (event_name='_100152',1,0) as _100152__count,
if (event_name='_100238',1,0) as _100238__count,
if (event_name='_100014',1,0) as _100014__count,
if (event_name='_200191',1,0) as _200191__count,
if (event_name='_100051',1,0) as _100051__flag,
if (event_name='_100144',1,0) as _100144__flag,
if (event_name='_100143',1,0) as _100143__flag,
if (event_name='_200210',1,0) as _200210__count,
if (event_name='_200045',1,0) as _200045__count,
if (event_name='_200089',1,0) as _200089__flag,
if (event_name='_100570',1,0) as _100570__count,
if (event_name='_100554', abstract_params(event_params,'item_number',1) ,null) as _100554__item_number,
if (event_name='_100543',1,0) as _100543__flag,
if (event_name='_100042',1,0) as _100042__count,
if (event_name='_200054',1,0) as _200054__flag,
if (event_name='_100074',1,0) as _100074__flag,
if (event_name='_200099',1,0) as _200099__flag,
if (event_name='_200174',1,0) as _200174__flag,
if (event_name='_200098',1,0) as _200098__flag,
if (event_name='_100027',1,0) as _100027__flag,
if (event_name='_100010',1,0) as _100010__flag,
if (event_name='_200173',1,0) as _200173__flag,
if (event_name='_100030',1,0) as _100030__count,
if (event_name='_100120',1,0) as _100120__flag,
if (event_name='_200082',1,0) as _200082__flag,
if (event_name='_100146',1,0) as _100146__flag,
if (event_name='_100059',1,0) as _100059__count,
if (event_name='_100111', abstract_params(event_params,'item_number',1) ,null) as _100111__item_number,
if (event_name='_100118',1,0) as _100118__flag,
if (event_name='_100006',1,0) as _100006__flag,
if (event_name='_200003',1,0) as _200003__flag,
if (event_name='_100021',1,0) as _100021__flag,
if (event_name='_200088',1,0) as _200088__flag,
if (event_name='_100104',1,0) as _100104__flag,
if (event_name='_200022',1,0) as _200022__flag,
if (event_name='_100235',1,0) as _100235__count,
if (event_name='_200023',1,0) as _200023__flag,
if (event_name='_100141',1,0) as _100141__flag,
if (event_name='_200104',1,0) as _200104__flag,
if (event_name='_100147',1,0) as _100147__flag,
if (event_name='_200048',1,0) as _200048__count,
if (event_name='_100040',1,0) as _100040__flag,
if (event_name='_100139',1,0) as _100139__flag,
if (event_name='_100532',1,0) as _100532__count,
if (event_name='_100203',1,0) as _100203__count,
if (event_name='_200205',1,0) as _200205__count,
if (event_name='_100016',1,0) as _100016__flag,
if (event_name='_100534',1,0) as _100534__flag,
if (event_name='_100207',1,0) as _100207__count,
if (event_name='login',1,0) as login__flag,
if (event_name='_200020',1,0) as _200020__flag,
if (event_name='_200093',1,0) as _200093__flag,
if (event_name='_100195',1,0) as _100195__flag,
if (event_name='_100078',1,0) as _100078__count,
if (event_name='_100015',1,0) as _100015__count,
if (event_name='_100066',1,0) as _100066__count,
if (event_name='_100071',1,0) as _100071__flag,
if (event_name='_100567',1,0) as _100567__count,
if (event_name='_200059',1,0) as _200059__count,
if (event_name='_200029',1,0) as _200029__count,
if (event_name='_100158',1,0) as _100158__flag,
if (event_name='_200192',1,0) as _200192__count,
if (event_name='_200227',1,0) as _200227__flag,
if (event_name='_200041',1,0) as _200041__flag,
if (event_name='_100571',1,0) as _100571__flag,
if (event_name='_100125',1,0) as _100125__flag,
if (event_name='_200096',1,0) as _200096__flag,
if (event_name='_100002',1,0) as _100002__flag,
if (event_name='_200017',1,0) as _200017__count,
if (event_name='_100048',1,0) as _100048__flag,
if (event_name='_200188',1,0) as _200188__flag,
if (event_name='_100576',1,0) as _100576__count,
if (event_name='_200015',1,0) as _200015__flag,
if (event_name='_200018',1,0) as _200018__count,
if (event_name='_100126',1,0) as _100126__flag,
if (event_name='role',1,0) as role__count
from `pltv-310710.originaldata_by_day.zsgl_events` 
where parse_date("%Y%m%d",safe_cast(event_date as string))  >= date_sub(current_date(), interval 60 day) 
), 
event_agg_by_day as ( 
select 
universal_user_id,
event_date, 
if(sum(login_flag)=0, 0,1) as login_flag, 
if(sum(pay_flag)=0, 0, 1 ) as pay_flag, 
ifnull(sum(case when event_name = '_200056' then _200056__count end),0) as _200056__count,
ifnull(sum(case when event_name = '_100211' then _100211__count end),0) as _100211__count,
ifnull(sum(case when event_name = '_100062' then _100062__count end),0) as _100062__count,
ifnull(sum(case when event_name = '_200036' then _200036__count end),0) as _200036__count,
ifnull(sum(case when event_name = '_200190' then _200190__count end),0) as _200190__count,
if(sum(case when event_name = '_100577' then _100577__flag end)>0,1,0) as _100577__flag,
if(sum(case when event_name = '_200179' then _200179__flag end)>0,1,0) as _200179__flag,
if(sum(case when event_name = '_100023' then _100023__flag end)>0,1,0) as _100023__flag,
if(sum(case when event_name = '_200079' then _200079__flag end)>0,1,0) as _200079__flag,
if(sum(case when event_name = '_100537' then _100537__flag end)>0,1,0) as _100537__flag,
if(sum(case when event_name = '_200051' then _200051__flag end)>0,1,0) as _200051__flag,
if(sum(case when event_name = '_200218' then _200218__flag end)>0,1,0) as _200218__flag,
if(sum(case when event_name = '_200157' then _200157__flag end)>0,1,0) as _200157__flag,
if(sum(case when event_name = '_100031' then _100031__flag end)>0,1,0) as _100031__flag,
ifnull(sum(case when event_name = '_100525' then _100525__count end),0) as _100525__count,
ifnull(sum(case when event_name = '_100097' then _100097__count end),0) as _100097__count,
if(sum(case when event_name = '_200177' then _200177__flag end)>0,1,0) as _200177__flag,
if(sum(case when event_name = '_100194' then _100194__flag end)>0,1,0) as _100194__flag,
if(sum(case when event_name = '_200050' then _200050__flag end)>0,1,0) as _200050__flag,
if(sum(case when event_name = '_200122' then _200122__flag end)>0,1,0) as _200122__flag,
if(sum(case when event_name = '_200114' then _200114__flag end)>0,1,0) as _200114__flag,
ifnull(sum(case when event_name = '_100547' then _100547__count end),0) as _100547__count,
if(sum(case when event_name = '_200037' then _200037__flag end)>0,1,0) as _200037__flag,
ifnull(sum(case when event_name = '_100186' then _100186__count end),0) as _100186__count,
if(sum(case when event_name = '_200121' then _200121__flag end)>0,1,0) as _200121__flag,
ifnull(sum(case when event_name = '_100109' then _100109__count end),0) as _100109__count,
ifnull(sum(case when event_name = '_100521' then _100521__count end),0) as _100521__count,
if(sum(case when event_name = '_100566' then _100566__flag end)>0,1,0) as _100566__flag,
if(sum(case when event_name = '_200032' then _200032__flag end)>0,1,0) as _200032__flag,
if(sum(case when event_name = '_100099' then _100099__flag end)>0,1,0) as _100099__flag,
ifnull(sum(case when event_name = '_100178' then _100178__count end),0) as _100178__count,
if(sum(case when event_name = '_100049' then _100049__flag end)>0,1,0) as _100049__flag,
if(sum(case when event_name = '_100578' then _100578__flag end)>0,1,0) as _100578__flag,
if(sum(case when event_name = '_200226' then _200226__flag end)>0,1,0) as _200226__flag,
if(sum(case when event_name = '_100004' then _100004__flag end)>0,1,0) as _100004__flag,
if(sum(case when event_name = '_200113' then _200113__flag end)>0,1,0) as _200113__flag,
if(sum(case when event_name = '_200033' then _200033__flag end)>0,1,0) as _200033__flag,
ifnull(sum(case when event_name = '_100156' then _100156__count end),0) as _100156__count,
if(sum(case when event_name = '_200204' then _200204__flag end)>0,1,0) as _200204__flag,
ifnull(sum(case when event_name = '_100199' then _100199__count end),0) as _100199__count,
if(sum(case when event_name = '_200024' then _200024__flag end)>0,1,0) as _200024__flag,
if(sum(case when event_name = '_100542' then _100542__flag end)>0,1,0) as _100542__flag,
if(sum(case when event_name = '_200144' then _200144__flag end)>0,1,0) as _200144__flag,
if(sum(case when event_name = '_200009' then _200009__flag end)>0,1,0) as _200009__flag,
if(sum(case when event_name = '_200101' then _200101__flag end)>0,1,0) as _200101__flag,
if(sum(case when event_name = '_100519' then _100519__flag end)>0,1,0) as _100519__flag,
if(sum(case when event_name = '_100069' then _100069__flag end)>0,1,0) as _100069__flag,
ifnull(sum(case when event_name = '_100574' then _100574__count end),0) as _100574__count,
if(sum(case when event_name = '_100122' then _100122__flag end)>0,1,0) as _100122__flag,
if(sum(case when event_name = '_200105' then _200105__flag end)>0,1,0) as _200105__flag,
if(sum(case when event_name = '_100131' then _100131__flag end)>0,1,0) as _100131__flag,
ifnull(sum(case when event_name = '_100022' then _100022__count end),0) as _100022__count,
if(sum(case when event_name = '_100588' then _100588__flag end)>0,1,0) as _100588__flag,
if(sum(case when event_name = '_200184' then _200184__flag end)>0,1,0) as _200184__flag,
ifnull(sum(case when event_name = 'pay' then pay__pay_money end),0) as pay__pay_money,
ifnull(sum(case when event_name = '_100516' then _100516__count end),0) as _100516__count,
ifnull(sum(case when event_name = '_100041' then _100041__count end),0) as _100041__count,
if(sum(case when event_name = '_200008' then _200008__flag end)>0,1,0) as _200008__flag,
if(sum(case when event_name = '_200108' then _200108__flag end)>0,1,0) as _200108__flag,
if(sum(case when event_name = '_100217' then _100217__flag end)>0,1,0) as _100217__flag,
if(sum(case when event_name = '_200064' then _200064__flag end)>0,1,0) as _200064__flag,
if(sum(case when event_name = '_100539' then _100539__flag end)>0,1,0) as _100539__flag,
ifnull(sum(case when event_name = '_100159' then _100159__count end),0) as _100159__count,
ifnull(sum(case when event_name = '_100101' then _100101__count end),0) as _100101__count,
ifnull(sum(case when event_name = '_100236' then _100236__count end),0) as _100236__count,
ifnull(sum(case when event_name = '_100080' then _100080__count end),0) as _100080__count,
if(sum(case when event_name = '_100193' then _100193__flag end)>0,1,0) as _100193__flag,
if(sum(case when event_name = '_100116' then _100116__flag end)>0,1,0) as _100116__flag,
ifnull(sum(case when event_name = '_100137' then _100137__count end),0) as _100137__count,
ifnull(sum(case when event_name = '_100514' then _100514__count end),0) as _100514__count,
if(sum(case when event_name = '_200147' then _200147__flag end)>0,1,0) as _200147__flag,
if(sum(case when event_name = '_100226' then _100226__flag end)>0,1,0) as _100226__flag,
ifnull(sum(case when event_name = '_100546' then _100546__count end),0) as _100546__count,
ifnull(sum(case when event_name = '_100138' then _100138__count end),0) as _100138__count,
ifnull(sum(case when event_name = '_100184' then _100184__count end),0) as _100184__count,
ifnull(sum(case when event_name = '_100013' then _100013__count end),0) as _100013__count,
ifnull(sum(case when event_name = '_100218' then _100218__count end),0) as _100218__count,
ifnull(sum(case when event_name = '_100153' then _100153__count end),0) as _100153__count,
if(sum(case when event_name = '_100020' then _100020__flag end)>0,1,0) as _100020__flag,
ifnull(sum(case when event_name = '_100070' then _100070__count end),0) as _100070__count,
if(sum(case when event_name = '_100557' then _100557__flag end)>0,1,0) as _100557__flag,
ifnull(sum(case when event_name = '_200176' then _200176__count end),0) as _200176__count,
ifnull(sum(case when event_name = '_100065' then _100065__count end),0) as _100065__count,
if(sum(case when event_name = '_200216' then _200216__flag end)>0,1,0) as _200216__flag,
if(sum(case when event_name = '_200145' then _200145__flag end)>0,1,0) as _200145__flag,
if(sum(case when event_name = '_200092' then _200092__flag end)>0,1,0) as _200092__flag,
ifnull(sum(case when event_name = '_100212' then _100212__count end),0) as _100212__count,
ifnull(sum(case when event_name = '_100054' then _100054__count end),0) as _100054__count,
ifnull(sum(case when event_name = '_200030' then _200030__count end),0) as _200030__count,
if(sum(case when event_name = '_200158' then _200158__flag end)>0,1,0) as _200158__flag,
if(sum(case when event_name = '_100202' then _100202__flag end)>0,1,0) as _100202__flag,
if(sum(case when event_name = '_100161' then _100161__flag end)>0,1,0) as _100161__flag,
if(sum(case when event_name = '_200016' then _200016__flag end)>0,1,0) as _200016__flag,
if(sum(case when event_name = '_200149' then _200149__flag end)>0,1,0) as _200149__flag,
ifnull(sum(case when event_name = '_100572' then _100572__count end),0) as _100572__count,
ifnull(sum(case when event_name = '_100162' then _100162__count end),0) as _100162__count,
ifnull(sum(case when event_name = '_100072' then _100072__count end),0) as _100072__count,
if(sum(case when event_name = '_200106' then _200106__flag end)>0,1,0) as _200106__flag,
if(sum(case when event_name = '_200117' then _200117__flag end)>0,1,0) as _200117__flag,
if(sum(case when event_name = '_200038' then _200038__flag end)>0,1,0) as _200038__flag,
if(sum(case when event_name = '_200214' then _200214__flag end)>0,1,0) as _200214__flag,
if(sum(case when event_name = '_200152' then _200152__flag end)>0,1,0) as _200152__flag,
if(sum(case when event_name = '_200168' then _200168__flag end)>0,1,0) as _200168__flag,
ifnull(sum(case when event_name = '_200007' then _200007__count end),0) as _200007__count,
ifnull(sum(case when event_name = '_200189' then _200189__count end),0) as _200189__count,
ifnull(sum(case when event_name = '_100569' then _100569__count end),0) as _100569__count,
ifnull(sum(case when event_name = '_100214' then _100214__count end),0) as _100214__count,
ifnull(sum(case when event_name = '_100012' then _100012__count end),0) as _100012__count,
ifnull(sum(case when event_name = '_100544' then _100544__count end),0) as _100544__count,
if(sum(case when event_name = '_100142' then _100142__flag end)>0,1,0) as _100142__flag,
if(sum(case when event_name = '_200072' then _200072__flag end)>0,1,0) as _200072__flag,
ifnull(sum(case when event_name = '_100148' then _100148__count end),0) as _100148__count,
ifnull(sum(case when event_name = '_100564' then _100564__count end),0) as _100564__count,
if(sum(case when event_name = '_200091' then _200091__flag end)>0,1,0) as _200091__flag,
ifnull(sum(case when event_name = '_100043' then _100043__count end),0) as _100043__count,
ifnull(sum(case when event_name = '_200095' then _200095__count end),0) as _200095__count,
ifnull(sum(case when event_name = '_200151' then _200151__count end),0) as _200151__count,
ifnull(sum(case when event_name = '_100209' then _100209__count end),0) as _100209__count,
ifnull(sum(case when event_name = '_200097' then _200097__count end),0) as _200097__count,
ifnull(sum(case when event_name = '_200213' then _200213__count end),0) as _200213__count,
ifnull(sum(case when event_name = '_100034' then _100034__count end),0) as _100034__count,
ifnull(sum(case when event_name = '_200058' then _200058__count end),0) as _200058__count,
ifnull(sum(case when event_name = '_200155' then _200155__count end),0) as _200155__count,
ifnull(sum(case when event_name = '_100533' then _100533__count end),0) as _100533__count,
ifnull(sum(case when event_name = '_100589' then _100589__count end),0) as _100589__count,
if(sum(case when event_name = '_200019' then _200019__flag end)>0,1,0) as _200019__flag,
ifnull(sum(case when event_name = '_200187' then _200187__count end),0) as _200187__count,
if(sum(case when event_name = '_200215' then _200215__flag end)>0,1,0) as _200215__flag,
ifnull(sum(case when event_name = '_100575' then _100575__count end),0) as _100575__count,
ifnull(sum(case when event_name = '_200178' then _200178__count end),0) as _200178__count,
ifnull(sum(case when event_name = '_100026' then _100026__count end),0) as _100026__count,
ifnull(sum(case when event_name = '_200109' then _200109__count end),0) as _200109__count,
ifnull(sum(case when event_name = '_100548' then _100548__count end),0) as _100548__count,
if(sum(case when event_name = '_100117' then _100117__flag end)>0,1,0) as _100117__flag,
ifnull(sum(case when event_name = '_100092' then _100092__count end),0) as _100092__count,
ifnull(sum(case when event_name = '_100170' then _100170__count end),0) as _100170__count,
ifnull(sum(case when event_name = '_100180' then _100180__count end),0) as _100180__count,
if(sum(case when event_name = '_100086' then _100086__flag end)>0,1,0) as _100086__flag,
ifnull(sum(case when event_name = '_100106' then _100106__item_number end),0) as _100106__item_number,
if(sum(case when event_name = '_200055' then _200055__flag end)>0,1,0) as _200055__flag,
ifnull(sum(case when event_name = '_200167' then _200167__count end),0) as _200167__count,
ifnull(sum(case when event_name = '_200220' then _200220__item_number end),0) as _200220__item_number,
if(sum(case when event_name = '_100213' then _100213__flag end)>0,1,0) as _100213__flag,
ifnull(sum(case when event_name = '_100565' then _100565__count end),0) as _100565__count,
ifnull(sum(case when event_name = '_200219' then _200219__count end),0) as _200219__count,
ifnull(sum(case when event_name = '_200223' then _200223__count end),0) as _200223__count,
if(sum(case when event_name = '_100112' then _100112__flag end)>0,1,0) as _100112__flag,
ifnull(sum(case when event_name = '_200217' then _200217__count end),0) as _200217__count,
ifnull(sum(case when event_name = '_100520' then _100520__count end),0) as _100520__count,
ifnull(sum(case when event_name = '_200115' then _200115__count end),0) as _200115__count,
ifnull(sum(case when event_name = '_200186' then _200186__count end),0) as _200186__count,
ifnull(sum(case when event_name = '_100029' then _100029__count end),0) as _100029__count,
ifnull(sum(case when event_name = '_200067' then _200067__count end),0) as _200067__count,
ifnull(sum(case when event_name = '_100540' then _100540__count end),0) as _100540__count,
ifnull(sum(case when event_name = '_100090' then _100090__count end),0) as _100090__count,
ifnull(sum(case when event_name = '_200002' then _200002__count end),0) as _200002__count,
ifnull(sum(case when event_name = '_100052' then _100052__count end),0) as _100052__count,
ifnull(sum(case when event_name = '_100061' then _100061__count end),0) as _100061__count,
if(sum(case when event_name = '_100017' then _100017__flag end)>0,1,0) as _100017__flag,
if(sum(case when event_name = '_200169' then _200169__flag end)>0,1,0) as _200169__flag,
ifnull(sum(case when event_name = '_100037' then _100037__count end),0) as _100037__count,
if(sum(case when event_name = '_100110' then _100110__flag end)>0,1,0) as _100110__flag,
if(sum(case when event_name = '_100154' then _100154__flag end)>0,1,0) as _100154__flag,
if(sum(case when event_name = '_200224' then _200224__flag end)>0,1,0) as _200224__flag,
if(sum(case when event_name = '_100586' then _100586__flag end)>0,1,0) as _100586__flag,
if(sum(case when event_name = '_200111' then _200111__flag end)>0,1,0) as _200111__flag,
if(sum(case when event_name = '_200021' then _200021__flag end)>0,1,0) as _200021__flag,
ifnull(sum(case when event_name = '_100536' then _100536__count end),0) as _100536__count,
ifnull(sum(case when event_name = '_100055' then _100055__item_number end),0) as _100055__item_number,
if(sum(case when event_name = '_200146' then _200146__flag end)>0,1,0) as _200146__flag,
if(sum(case when event_name = '_100018' then _100018__flag end)>0,1,0) as _100018__flag,
if(sum(case when event_name = '_100168' then _100168__flag end)>0,1,0) as _100168__flag,
if(sum(case when event_name = '_100007' then _100007__flag end)>0,1,0) as _100007__flag,
if(sum(case when event_name = '_200069' then _200069__flag end)>0,1,0) as _200069__flag,
if(sum(case when event_name = '_100563' then _100563__flag end)>0,1,0) as _100563__flag,
if(sum(case when event_name = '_100513' then _100513__flag end)>0,1,0) as _100513__flag,
ifnull(sum(case when event_name = '_100060' then _100060__item_number end),0) as _100060__item_number,
if(sum(case when event_name = '_100130' then _100130__flag end)>0,1,0) as _100130__flag,
ifnull(sum(case when event_name = '_100568' then _100568__count end),0) as _100568__count,
if(sum(case when event_name = '_100128' then _100128__flag end)>0,1,0) as _100128__flag,
ifnull(sum(case when event_name = '_100024' then _100024__item_number end),0) as _100024__item_number,
if(sum(case when event_name = '_100064' then _100064__flag end)>0,1,0) as _100064__flag,
if(sum(case when event_name = '_100538' then _100538__flag end)>0,1,0) as _100538__flag,
ifnull(sum(case when event_name = '_100093' then _100093__item_number end),0) as _100093__item_number,
if(sum(case when event_name = '_200161' then _200161__flag end)>0,1,0) as _200161__flag,
if(sum(case when event_name = '_100095' then _100095__flag end)>0,1,0) as _100095__flag,
ifnull(sum(case when event_name = '_100166' then _100166__count end),0) as _100166__count,
ifnull(sum(case when event_name = '_200212' then _200212__count end),0) as _200212__count,
ifnull(sum(case when event_name = 'gold' then gold__amount end),0) as gold__amount,
if(sum(case when event_name = '_200013' then _200013__flag end)>0,1,0) as _200013__flag,
if(sum(case when event_name = '_200100' then _200100__flag end)>0,1,0) as _200100__flag,
if(sum(case when event_name = '_200004' then _200004__flag end)>0,1,0) as _200004__flag,
ifnull(sum(case when event_name = '_100592' then _100592__count end),0) as _100592__count,
if(sum(case when event_name = '_100140' then _100140__flag end)>0,1,0) as _100140__flag,
if(sum(case when event_name = '_100019' then _100019__flag end)>0,1,0) as _100019__flag,
if(sum(case when event_name = '_100053' then _100053__flag end)>0,1,0) as _100053__flag,
if(sum(case when event_name = '_100515' then _100515__flag end)>0,1,0) as _100515__flag,
if(sum(case when event_name = '_200107' then _200107__flag end)>0,1,0) as _200107__flag,
if(sum(case when event_name = '_100155' then _100155__flag end)>0,1,0) as _100155__flag,
if(sum(case when event_name = '_100169' then _100169__flag end)>0,1,0) as _100169__flag,
ifnull(sum(case when event_name = '_200077' then _200077__count end),0) as _200077__count,
ifnull(sum(case when event_name = '_200081' then _200081__count end),0) as _200081__count,
ifnull(sum(case when event_name = '_100063' then _100063__item_number end),0) as _100063__item_number,
if(sum(case when event_name = '_200010' then _200010__flag end)>0,1,0) as _200010__flag,
ifnull(sum(case when event_name = '_100245' then _100245__count end),0) as _100245__count,
if(sum(case when event_name = 'quit' then quit__flag end)>0,1,0) as quit__flag,
if(sum(case when event_name = '_200006' then _200006__flag end)>0,1,0) as _200006__flag,
if(sum(case when event_name = '_200063' then _200063__flag end)>0,1,0) as _200063__flag,
if(sum(case when event_name = '_200046' then _200046__flag end)>0,1,0) as _200046__flag,
if(sum(case when event_name = '_100145' then _100145__flag end)>0,1,0) as _100145__flag,
ifnull(sum(case when event_name = '_100152' then _100152__count end),0) as _100152__count,
ifnull(sum(case when event_name = '_100238' then _100238__count end),0) as _100238__count,
ifnull(sum(case when event_name = '_100014' then _100014__count end),0) as _100014__count,
ifnull(sum(case when event_name = '_200191' then _200191__count end),0) as _200191__count,
if(sum(case when event_name = '_100051' then _100051__flag end)>0,1,0) as _100051__flag,
if(sum(case when event_name = '_100144' then _100144__flag end)>0,1,0) as _100144__flag,
if(sum(case when event_name = '_100143' then _100143__flag end)>0,1,0) as _100143__flag,
ifnull(sum(case when event_name = '_200210' then _200210__count end),0) as _200210__count,
ifnull(sum(case when event_name = '_200045' then _200045__count end),0) as _200045__count,
if(sum(case when event_name = '_200089' then _200089__flag end)>0,1,0) as _200089__flag,
ifnull(sum(case when event_name = '_100570' then _100570__count end),0) as _100570__count,
ifnull(sum(case when event_name = '_100554' then _100554__item_number end),0) as _100554__item_number,
if(sum(case when event_name = '_100543' then _100543__flag end)>0,1,0) as _100543__flag,
ifnull(sum(case when event_name = '_100042' then _100042__count end),0) as _100042__count,
if(sum(case when event_name = '_200054' then _200054__flag end)>0,1,0) as _200054__flag,
if(sum(case when event_name = '_100074' then _100074__flag end)>0,1,0) as _100074__flag,
if(sum(case when event_name = '_200099' then _200099__flag end)>0,1,0) as _200099__flag,
if(sum(case when event_name = '_200174' then _200174__flag end)>0,1,0) as _200174__flag,
if(sum(case when event_name = '_200098' then _200098__flag end)>0,1,0) as _200098__flag,
if(sum(case when event_name = '_100027' then _100027__flag end)>0,1,0) as _100027__flag,
if(sum(case when event_name = '_100010' then _100010__flag end)>0,1,0) as _100010__flag,
if(sum(case when event_name = '_200173' then _200173__flag end)>0,1,0) as _200173__flag,
ifnull(sum(case when event_name = '_100030' then _100030__count end),0) as _100030__count,
if(sum(case when event_name = '_100120' then _100120__flag end)>0,1,0) as _100120__flag,
if(sum(case when event_name = '_200082' then _200082__flag end)>0,1,0) as _200082__flag,
if(sum(case when event_name = '_100146' then _100146__flag end)>0,1,0) as _100146__flag,
ifnull(sum(case when event_name = '_100059' then _100059__count end),0) as _100059__count,
ifnull(sum(case when event_name = '_100111' then _100111__item_number end),0) as _100111__item_number,
if(sum(case when event_name = '_100118' then _100118__flag end)>0,1,0) as _100118__flag,
if(sum(case when event_name = '_100006' then _100006__flag end)>0,1,0) as _100006__flag,
if(sum(case when event_name = '_200003' then _200003__flag end)>0,1,0) as _200003__flag,
if(sum(case when event_name = '_100021' then _100021__flag end)>0,1,0) as _100021__flag,
if(sum(case when event_name = '_200088' then _200088__flag end)>0,1,0) as _200088__flag,
if(sum(case when event_name = '_100104' then _100104__flag end)>0,1,0) as _100104__flag,
if(sum(case when event_name = '_200022' then _200022__flag end)>0,1,0) as _200022__flag,
ifnull(sum(case when event_name = '_100235' then _100235__count end),0) as _100235__count,
if(sum(case when event_name = '_200023' then _200023__flag end)>0,1,0) as _200023__flag,
if(sum(case when event_name = '_100141' then _100141__flag end)>0,1,0) as _100141__flag,
if(sum(case when event_name = '_200104' then _200104__flag end)>0,1,0) as _200104__flag,
if(sum(case when event_name = '_100147' then _100147__flag end)>0,1,0) as _100147__flag,
ifnull(sum(case when event_name = '_200048' then _200048__count end),0) as _200048__count,
if(sum(case when event_name = '_100040' then _100040__flag end)>0,1,0) as _100040__flag,
if(sum(case when event_name = '_100139' then _100139__flag end)>0,1,0) as _100139__flag,
ifnull(sum(case when event_name = '_100532' then _100532__count end),0) as _100532__count,
ifnull(sum(case when event_name = '_100203' then _100203__count end),0) as _100203__count,
ifnull(sum(case when event_name = '_200205' then _200205__count end),0) as _200205__count,
if(sum(case when event_name = '_100016' then _100016__flag end)>0,1,0) as _100016__flag,
if(sum(case when event_name = '_100534' then _100534__flag end)>0,1,0) as _100534__flag,
ifnull(sum(case when event_name = '_100207' then _100207__count end),0) as _100207__count,
if(sum(case when event_name = 'login' then login__flag end)>0,1,0) as login__flag,
if(sum(case when event_name = '_200020' then _200020__flag end)>0,1,0) as _200020__flag,
if(sum(case when event_name = '_200093' then _200093__flag end)>0,1,0) as _200093__flag,
if(sum(case when event_name = '_100195' then _100195__flag end)>0,1,0) as _100195__flag,
ifnull(sum(case when event_name = '_100078' then _100078__count end),0) as _100078__count,
ifnull(sum(case when event_name = '_100015' then _100015__count end),0) as _100015__count,
ifnull(sum(case when event_name = '_100066' then _100066__count end),0) as _100066__count,
if(sum(case when event_name = '_100071' then _100071__flag end)>0,1,0) as _100071__flag,
ifnull(sum(case when event_name = '_100567' then _100567__count end),0) as _100567__count,
ifnull(sum(case when event_name = '_200059' then _200059__count end),0) as _200059__count,
ifnull(sum(case when event_name = '_200029' then _200029__count end),0) as _200029__count,
if(sum(case when event_name = '_100158' then _100158__flag end)>0,1,0) as _100158__flag,
ifnull(sum(case when event_name = '_200192' then _200192__count end),0) as _200192__count,
if(sum(case when event_name = '_200227' then _200227__flag end)>0,1,0) as _200227__flag,
if(sum(case when event_name = '_200041' then _200041__flag end)>0,1,0) as _200041__flag,
if(sum(case when event_name = '_100571' then _100571__flag end)>0,1,0) as _100571__flag,
if(sum(case when event_name = '_100125' then _100125__flag end)>0,1,0) as _100125__flag,
if(sum(case when event_name = '_200096' then _200096__flag end)>0,1,0) as _200096__flag,
if(sum(case when event_name = '_100002' then _100002__flag end)>0,1,0) as _100002__flag,
ifnull(sum(case when event_name = '_200017' then _200017__count end),0) as _200017__count,
if(sum(case when event_name = '_100048' then _100048__flag end)>0,1,0) as _100048__flag,
if(sum(case when event_name = '_200188' then _200188__flag end)>0,1,0) as _200188__flag,
ifnull(sum(case when event_name = '_100576' then _100576__count end),0) as _100576__count,
if(sum(case when event_name = '_200015' then _200015__flag end)>0,1,0) as _200015__flag,
ifnull(sum(case when event_name = '_200018' then _200018__count end),0) as _200018__count,
if(sum(case when event_name = '_100126' then _100126__flag end)>0,1,0) as _100126__flag,
ifnull(sum(case when event_name = 'role' then role__count end),0) as role__count
from data_flat_1
group by universal_user_id, event_date 
) 
select 
a.*, 
ifnull(b.login_flag,0) as login_flag, 
ifnull(b.pay_flag,0) as pay_flag, 
 ifnull(b._200056__count,0) as _200056__count,
ifnull(b._100211__count,0) as _100211__count,
ifnull(b._100062__count,0) as _100062__count,
ifnull(b._200036__count,0) as _200036__count,
ifnull(b._200190__count,0) as _200190__count,
ifnull(b._100577__flag,0) as _100577__flag,
ifnull(b._200179__flag,0) as _200179__flag,
ifnull(b._100023__flag,0) as _100023__flag,
ifnull(b._200079__flag,0) as _200079__flag,
ifnull(b._100537__flag,0) as _100537__flag,
ifnull(b._200051__flag,0) as _200051__flag,
ifnull(b._200218__flag,0) as _200218__flag,
ifnull(b._200157__flag,0) as _200157__flag,
ifnull(b._100031__flag,0) as _100031__flag,
ifnull(b._100525__count,0) as _100525__count,
ifnull(b._100097__count,0) as _100097__count,
ifnull(b._200177__flag,0) as _200177__flag,
ifnull(b._100194__flag,0) as _100194__flag,
ifnull(b._200050__flag,0) as _200050__flag,
ifnull(b._200122__flag,0) as _200122__flag,
ifnull(b._200114__flag,0) as _200114__flag,
ifnull(b._100547__count,0) as _100547__count,
ifnull(b._200037__flag,0) as _200037__flag,
ifnull(b._100186__count,0) as _100186__count,
ifnull(b._200121__flag,0) as _200121__flag,
ifnull(b._100109__count,0) as _100109__count,
ifnull(b._100521__count,0) as _100521__count,
ifnull(b._100566__flag,0) as _100566__flag,
ifnull(b._200032__flag,0) as _200032__flag,
ifnull(b._100099__flag,0) as _100099__flag,
ifnull(b._100178__count,0) as _100178__count,
ifnull(b._100049__flag,0) as _100049__flag,
ifnull(b._100578__flag,0) as _100578__flag,
ifnull(b._200226__flag,0) as _200226__flag,
ifnull(b._100004__flag,0) as _100004__flag,
ifnull(b._200113__flag,0) as _200113__flag,
ifnull(b._200033__flag,0) as _200033__flag,
ifnull(b._100156__count,0) as _100156__count,
ifnull(b._200204__flag,0) as _200204__flag,
ifnull(b._100199__count,0) as _100199__count,
ifnull(b._200024__flag,0) as _200024__flag,
ifnull(b._100542__flag,0) as _100542__flag,
ifnull(b._200144__flag,0) as _200144__flag,
ifnull(b._200009__flag,0) as _200009__flag,
ifnull(b._200101__flag,0) as _200101__flag,
ifnull(b._100519__flag,0) as _100519__flag,
ifnull(b._100069__flag,0) as _100069__flag,
ifnull(b._100574__count,0) as _100574__count,
ifnull(b._100122__flag,0) as _100122__flag,
ifnull(b._200105__flag,0) as _200105__flag,
ifnull(b._100131__flag,0) as _100131__flag,
ifnull(b._100022__count,0) as _100022__count,
ifnull(b._100588__flag,0) as _100588__flag,
ifnull(b._200184__flag,0) as _200184__flag,
ifnull(b.pay__pay_money,0) as pay__pay_money,
ifnull(b._100516__count,0) as _100516__count,
ifnull(b._100041__count,0) as _100041__count,
ifnull(b._200008__flag,0) as _200008__flag,
ifnull(b._200108__flag,0) as _200108__flag,
ifnull(b._100217__flag,0) as _100217__flag,
ifnull(b._200064__flag,0) as _200064__flag,
ifnull(b._100539__flag,0) as _100539__flag,
ifnull(b._100159__count,0) as _100159__count,
ifnull(b._100101__count,0) as _100101__count,
ifnull(b._100236__count,0) as _100236__count,
ifnull(b._100080__count,0) as _100080__count,
ifnull(b._100193__flag,0) as _100193__flag,
ifnull(b._100116__flag,0) as _100116__flag,
ifnull(b._100137__count,0) as _100137__count,
ifnull(b._100514__count,0) as _100514__count,
ifnull(b._200147__flag,0) as _200147__flag,
ifnull(b._100226__flag,0) as _100226__flag,
ifnull(b._100546__count,0) as _100546__count,
ifnull(b._100138__count,0) as _100138__count,
ifnull(b._100184__count,0) as _100184__count,
ifnull(b._100013__count,0) as _100013__count,
ifnull(b._100218__count,0) as _100218__count,
ifnull(b._100153__count,0) as _100153__count,
ifnull(b._100020__flag,0) as _100020__flag,
ifnull(b._100070__count,0) as _100070__count,
ifnull(b._100557__flag,0) as _100557__flag,
ifnull(b._200176__count,0) as _200176__count,
ifnull(b._100065__count,0) as _100065__count,
ifnull(b._200216__flag,0) as _200216__flag,
ifnull(b._200145__flag,0) as _200145__flag,
ifnull(b._200092__flag,0) as _200092__flag,
ifnull(b._100212__count,0) as _100212__count,
ifnull(b._100054__count,0) as _100054__count,
ifnull(b._200030__count,0) as _200030__count,
ifnull(b._200158__flag,0) as _200158__flag,
ifnull(b._100202__flag,0) as _100202__flag,
ifnull(b._100161__flag,0) as _100161__flag,
ifnull(b._200016__flag,0) as _200016__flag,
ifnull(b._200149__flag,0) as _200149__flag,
ifnull(b._100572__count,0) as _100572__count,
ifnull(b._100162__count,0) as _100162__count,
ifnull(b._100072__count,0) as _100072__count,
ifnull(b._200106__flag,0) as _200106__flag,
ifnull(b._200117__flag,0) as _200117__flag,
ifnull(b._200038__flag,0) as _200038__flag,
ifnull(b._200214__flag,0) as _200214__flag,
ifnull(b._200152__flag,0) as _200152__flag,
ifnull(b._200168__flag,0) as _200168__flag,
ifnull(b._200007__count,0) as _200007__count,
ifnull(b._200189__count,0) as _200189__count,
ifnull(b._100569__count,0) as _100569__count,
ifnull(b._100214__count,0) as _100214__count,
ifnull(b._100012__count,0) as _100012__count,
ifnull(b._100544__count,0) as _100544__count,
ifnull(b._100142__flag,0) as _100142__flag,
ifnull(b._200072__flag,0) as _200072__flag,
ifnull(b._100148__count,0) as _100148__count,
ifnull(b._100564__count,0) as _100564__count,
ifnull(b._200091__flag,0) as _200091__flag,
ifnull(b._100043__count,0) as _100043__count,
ifnull(b._200095__count,0) as _200095__count,
ifnull(b._200151__count,0) as _200151__count,
ifnull(b._100209__count,0) as _100209__count,
ifnull(b._200097__count,0) as _200097__count,
ifnull(b._200213__count,0) as _200213__count,
ifnull(b._100034__count,0) as _100034__count,
ifnull(b._200058__count,0) as _200058__count,
ifnull(b._200155__count,0) as _200155__count,
ifnull(b._100533__count,0) as _100533__count,
ifnull(b._100589__count,0) as _100589__count,
ifnull(b._200019__flag,0) as _200019__flag,
ifnull(b._200187__count,0) as _200187__count,
ifnull(b._200215__flag,0) as _200215__flag,
ifnull(b._100575__count,0) as _100575__count,
ifnull(b._200178__count,0) as _200178__count,
ifnull(b._100026__count,0) as _100026__count,
ifnull(b._200109__count,0) as _200109__count,
ifnull(b._100548__count,0) as _100548__count,
ifnull(b._100117__flag,0) as _100117__flag,
ifnull(b._100092__count,0) as _100092__count,
ifnull(b._100170__count,0) as _100170__count,
ifnull(b._100180__count,0) as _100180__count,
ifnull(b._100086__flag,0) as _100086__flag,
ifnull(b._100106__item_number,0) as _100106__item_number,
ifnull(b._200055__flag,0) as _200055__flag,
ifnull(b._200167__count,0) as _200167__count,
ifnull(b._200220__item_number,0) as _200220__item_number,
ifnull(b._100213__flag,0) as _100213__flag,
ifnull(b._100565__count,0) as _100565__count,
ifnull(b._200219__count,0) as _200219__count,
ifnull(b._200223__count,0) as _200223__count,
ifnull(b._100112__flag,0) as _100112__flag,
ifnull(b._200217__count,0) as _200217__count,
ifnull(b._100520__count,0) as _100520__count,
ifnull(b._200115__count,0) as _200115__count,
ifnull(b._200186__count,0) as _200186__count,
ifnull(b._100029__count,0) as _100029__count,
ifnull(b._200067__count,0) as _200067__count,
ifnull(b._100540__count,0) as _100540__count,
ifnull(b._100090__count,0) as _100090__count,
ifnull(b._200002__count,0) as _200002__count,
ifnull(b._100052__count,0) as _100052__count,
ifnull(b._100061__count,0) as _100061__count,
ifnull(b._100017__flag,0) as _100017__flag,
ifnull(b._200169__flag,0) as _200169__flag,
ifnull(b._100037__count,0) as _100037__count,
ifnull(b._100110__flag,0) as _100110__flag,
ifnull(b._100154__flag,0) as _100154__flag,
ifnull(b._200224__flag,0) as _200224__flag,
ifnull(b._100586__flag,0) as _100586__flag,
ifnull(b._200111__flag,0) as _200111__flag,
ifnull(b._200021__flag,0) as _200021__flag,
ifnull(b._100536__count,0) as _100536__count,
ifnull(b._100055__item_number,0) as _100055__item_number,
ifnull(b._200146__flag,0) as _200146__flag,
ifnull(b._100018__flag,0) as _100018__flag,
ifnull(b._100168__flag,0) as _100168__flag,
ifnull(b._100007__flag,0) as _100007__flag,
ifnull(b._200069__flag,0) as _200069__flag,
ifnull(b._100563__flag,0) as _100563__flag,
ifnull(b._100513__flag,0) as _100513__flag,
ifnull(b._100060__item_number,0) as _100060__item_number,
ifnull(b._100130__flag,0) as _100130__flag,
ifnull(b._100568__count,0) as _100568__count,
ifnull(b._100128__flag,0) as _100128__flag,
ifnull(b._100024__item_number,0) as _100024__item_number,
ifnull(b._100064__flag,0) as _100064__flag,
ifnull(b._100538__flag,0) as _100538__flag,
ifnull(b._100093__item_number,0) as _100093__item_number,
ifnull(b._200161__flag,0) as _200161__flag,
ifnull(b._100095__flag,0) as _100095__flag,
ifnull(b._100166__count,0) as _100166__count,
ifnull(b._200212__count,0) as _200212__count,
ifnull(b.gold__amount,0) as gold__amount,
ifnull(b._200013__flag,0) as _200013__flag,
ifnull(b._200100__flag,0) as _200100__flag,
ifnull(b._200004__flag,0) as _200004__flag,
ifnull(b._100592__count,0) as _100592__count,
ifnull(b._100140__flag,0) as _100140__flag,
ifnull(b._100019__flag,0) as _100019__flag,
ifnull(b._100053__flag,0) as _100053__flag,
ifnull(b._100515__flag,0) as _100515__flag,
ifnull(b._200107__flag,0) as _200107__flag,
ifnull(b._100155__flag,0) as _100155__flag,
ifnull(b._100169__flag,0) as _100169__flag,
ifnull(b._200077__count,0) as _200077__count,
ifnull(b._200081__count,0) as _200081__count,
ifnull(b._100063__item_number,0) as _100063__item_number,
ifnull(b._200010__flag,0) as _200010__flag,
ifnull(b._100245__count,0) as _100245__count,
ifnull(b.quit__flag,0) as quit__flag,
ifnull(b._200006__flag,0) as _200006__flag,
ifnull(b._200063__flag,0) as _200063__flag,
ifnull(b._200046__flag,0) as _200046__flag,
ifnull(b._100145__flag,0) as _100145__flag,
ifnull(b._100152__count,0) as _100152__count,
ifnull(b._100238__count,0) as _100238__count,
ifnull(b._100014__count,0) as _100014__count,
ifnull(b._200191__count,0) as _200191__count,
ifnull(b._100051__flag,0) as _100051__flag,
ifnull(b._100144__flag,0) as _100144__flag,
ifnull(b._100143__flag,0) as _100143__flag,
ifnull(b._200210__count,0) as _200210__count,
ifnull(b._200045__count,0) as _200045__count,
ifnull(b._200089__flag,0) as _200089__flag,
ifnull(b._100570__count,0) as _100570__count,
ifnull(b._100554__item_number,0) as _100554__item_number,
ifnull(b._100543__flag,0) as _100543__flag,
ifnull(b._100042__count,0) as _100042__count,
ifnull(b._200054__flag,0) as _200054__flag,
ifnull(b._100074__flag,0) as _100074__flag,
ifnull(b._200099__flag,0) as _200099__flag,
ifnull(b._200174__flag,0) as _200174__flag,
ifnull(b._200098__flag,0) as _200098__flag,
ifnull(b._100027__flag,0) as _100027__flag,
ifnull(b._100010__flag,0) as _100010__flag,
ifnull(b._200173__flag,0) as _200173__flag,
ifnull(b._100030__count,0) as _100030__count,
ifnull(b._100120__flag,0) as _100120__flag,
ifnull(b._200082__flag,0) as _200082__flag,
ifnull(b._100146__flag,0) as _100146__flag,
ifnull(b._100059__count,0) as _100059__count,
ifnull(b._100111__item_number,0) as _100111__item_number,
ifnull(b._100118__flag,0) as _100118__flag,
ifnull(b._100006__flag,0) as _100006__flag,
ifnull(b._200003__flag,0) as _200003__flag,
ifnull(b._100021__flag,0) as _100021__flag,
ifnull(b._200088__flag,0) as _200088__flag,
ifnull(b._100104__flag,0) as _100104__flag,
ifnull(b._200022__flag,0) as _200022__flag,
ifnull(b._100235__count,0) as _100235__count,
ifnull(b._200023__flag,0) as _200023__flag,
ifnull(b._100141__flag,0) as _100141__flag,
ifnull(b._200104__flag,0) as _200104__flag,
ifnull(b._100147__flag,0) as _100147__flag,
ifnull(b._200048__count,0) as _200048__count,
ifnull(b._100040__flag,0) as _100040__flag,
ifnull(b._100139__flag,0) as _100139__flag,
ifnull(b._100532__count,0) as _100532__count,
ifnull(b._100203__count,0) as _100203__count,
ifnull(b._200205__count,0) as _200205__count,
ifnull(b._100016__flag,0) as _100016__flag,
ifnull(b._100534__flag,0) as _100534__flag,
ifnull(b._100207__count,0) as _100207__count,
ifnull(b.login__flag,0) as login__flag,
ifnull(b._200020__flag,0) as _200020__flag,
ifnull(b._200093__flag,0) as _200093__flag,
ifnull(b._100195__flag,0) as _100195__flag,
ifnull(b._100078__count,0) as _100078__count,
ifnull(b._100015__count,0) as _100015__count,
ifnull(b._100066__count,0) as _100066__count,
ifnull(b._100071__flag,0) as _100071__flag,
ifnull(b._100567__count,0) as _100567__count,
ifnull(b._200059__count,0) as _200059__count,
ifnull(b._200029__count,0) as _200029__count,
ifnull(b._100158__flag,0) as _100158__flag,
ifnull(b._200192__count,0) as _200192__count,
ifnull(b._200227__flag,0) as _200227__flag,
ifnull(b._200041__flag,0) as _200041__flag,
ifnull(b._100571__flag,0) as _100571__flag,
ifnull(b._100125__flag,0) as _100125__flag,
ifnull(b._200096__flag,0) as _200096__flag,
ifnull(b._100002__flag,0) as _100002__flag,
ifnull(b._200017__count,0) as _200017__count,
ifnull(b._100048__flag,0) as _100048__flag,
ifnull(b._200188__flag,0) as _200188__flag,
ifnull(b._100576__count,0) as _100576__count,
ifnull(b._200015__flag,0) as _200015__flag,
ifnull(b._200018__count,0) as _200018__count,
ifnull(b._100126__flag,0) as _100126__flag,
ifnull(b.role__count,0) as role__count,
current_timestamp() as collect_time 
from full_user_date a 
left join event_agg_by_day b 
on a.universal_user_id=b.universal_user_id
and a.event_date=b.event_date