--This script calcualte the rolling_sum as of event_date for each event of each customer based on table_B which is the destination table in schedule_job_B. 
--Step 1: Change xxxxx in sql below to table_B. 
--Step 2: Run and validate the query in bigquery 
--Step 3: Create a schedule job(aka:schedule_job_C) to write the query  result to table_C.
select 
universal_user_id,
install_date,
event_date,
login_flag, 
pay_flag, 
platform, 
country, 
sum(ArmyMessageHanlder__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as ArmyMessageHanlder__count__sum,
sum(DigGroundClickTipsAfterUpgrade__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as DigGroundClickTipsAfterUpgrade__count__sum,
sum(ArenaLastRecord__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as ArenaLastRecord__count__sum,
sum(PVECheckpointBattleStart__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as PVECheckpointBattleStart__count__sum,
sum(completedRegistration__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as completedRegistration__count__sum,
sum(AllianceApplyList__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceApplyList__count__sum,
sum(GarageFormationRepairInfo__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as GarageFormationRepairInfo__count__sum,
sum(AddComplete__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AddComplete__count__sum,
sum(DigGroundStationed__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as DigGroundStationed__count__sum,
sum(AlSiegeWaveRecord__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AlSiegeWaveRecord__count__sum,
sum(AllianceApplyMsg__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceApplyMsg__count__sum,
sum(MarkMailStatus__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as MarkMailStatus__count__sum,
sum(ScienceResearch__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as ScienceResearch__count__sum,
sum(PlayerFormationExtensionSave__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as PlayerFormationExtensionSave__count__sum,
sum(ZoneShopRefresh__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as ZoneShopRefresh__count__sum,
sum(AllianceLogBattleView__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceLogBattleView__count__sum,
sum(ShowStatusItem__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as ShowStatusItem__count__sum,
sum(PlayerFormationClientInfo__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as PlayerFormationClientInfo__count__sum,
sum(DigTradeGetUserProperties__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as DigTradeGetUserProperties__count__sum,
sum(appLaunches__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as appLaunches__count__sum,
sum(PowerRankingHandler__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as PowerRankingHandler__count__sum,
sum(RegionForceRankingHandler__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as RegionForceRankingHandler__count__sum,
sum(BattlePassGetUserBuyAdvanceExp__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as BattlePassGetUserBuyAdvanceExp__count__sum,
sum(LocalPersonalRankInfo__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as LocalPersonalRankInfo__count__sum,
sum(DigUserRecyclingResource__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as DigUserRecyclingResource__count__sum,
sum(GetNewPlayerInfo__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as GetNewPlayerInfo__count__sum,
sum(GetWorldCityInfo__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as GetWorldCityInfo__count__sum,
sum(UserAllianceLevelEffectView__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as UserAllianceLevelEffectView__count__sum,
sum(DigFoodCookCancelAndCook__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as DigFoodCookCancelAndCook__count__sum,
sum(BattleEntrance__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as BattleEntrance__count__sum,
sum(PersonalGiftClicked__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as PersonalGiftClicked__count__sum,
sum(EquipLockHandler__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as EquipLockHandler__count__sum,
sum(AcceptPersonalActivityReward__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AcceptPersonalActivityReward__count__sum,
sum(AllianceDailyTaskView__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceDailyTaskView__count__sum,
sum(UseItem__num) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as UseItem__num__sum,
sum(DigGroundBuildUplevelGold__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as DigGroundBuildUplevelGold__count__sum,
sum(PlayerFormationSave__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as PlayerFormationSave__count__sum,
sum(AllianceMilitaryMeritExchangeItems__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceMilitaryMeritExchangeItems__count__sum,
sum(DigGroundStationedExp__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as DigGroundStationedExp__count__sum,
sum(UserArmsEffectInfo__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as UserArmsEffectInfo__count__sum,
sum(PowerAllianceRankingHandler__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as PowerAllianceRankingHandler__count__sum,
sum(ArenaReportDetailInfo__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as ArenaReportDetailInfo__count__sum,
sum(HonorEditCmd__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as HonorEditCmd__count__sum,
sum(AllianceTransferServerList__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceTransferServerList__count__sum,
sum(MailRewardBatch__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as MailRewardBatch__count__sum,
sum(SerialKillingClaimReward__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as SerialKillingClaimReward__count__sum,
sum(ZoneHonorReward__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as ZoneHonorReward__count__sum,
sum(AllianceCrossApplyPreview__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceCrossApplyPreview__count__sum,
sum(SetShowQuality__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as SetShowQuality__count__sum,
sum(ServerTrendsReward__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as ServerTrendsReward__count__sum,
sum(AllianceRewardAllRemove__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceRewardAllRemove__count__sum,
sum(CureFinish__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as CureFinish__count__sum,
sum(HonorGetInfoCmd__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as HonorGetInfoCmd__count__sum,
sum(AlSiegePanelReward__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AlSiegePanelReward__count__sum,
sum(BoxGiftReward__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as BoxGiftReward__count__sum,
sum(PVEGetInfo__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as PVEGetInfo__count__sum,
sum(UserExpeditionLook__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as UserExpeditionLook__count__sum,
sum(LotteryHeroCard__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as LotteryHeroCard__count__sum,
sum(UserExpeditionEffectInfo__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as UserExpeditionEffectInfo__count__sum,
sum(EliteNewRefreshData__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as EliteNewRefreshData__count__sum,
sum(DigGroundBuildUplevel__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as DigGroundBuildUplevel__count__sum,
sum(GetRankingBasePanelInfo__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as GetRankingBasePanelInfo__count__sum,
sum(UserPayReward__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as UserPayReward__count__sum,
sum(AllianceMilitaryMeritGet__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceMilitaryMeritGet__count__sum,
sum(UserAllianceDevelopDonateView__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as UserAllianceDevelopDonateView__count__sum,
sum(DigHeroHandler__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as DigHeroHandler__count__sum,
sum(LFFormationMarchTime__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as LFFormationMarchTime__count__sum,
sum(ZoneShopExchange__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as ZoneShopExchange__count__sum,
sum(ZoneHonorChange__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as ZoneHonorChange__count__sum,
sum(ZoneShopView__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as ZoneShopView__count__sum,
sum(AllianceReinforceList__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceReinforceList__count__sum,
sum(AddSoldier__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AddSoldier__count__sum,
sum(ArenaRematch__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as ArenaRematch__count__sum,
sum(AllianceShopUsrBuyRecord__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceShopUsrBuyRecord__count__sum,
sum(SoldierUpgradeComplete__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as SoldierUpgradeComplete__count__sum,
sum(DigFoodCookCancel__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as DigFoodCookCancel__count__sum,
sum(AcceptTaskReward__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AcceptTaskReward__count__sum,
sum(DigGroundBuildUplevelNoHeroes__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as DigGroundBuildUplevelNoHeroes__count__sum,
sum(AllianceCommentView__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceCommentView__count__sum,
sum(BuildingRankingHandler__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as BuildingRankingHandler__count__sum,
sum(GetFoodProduce__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as GetFoodProduce__count__sum,
sum(PVEClearanceReplay__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as PVEClearanceReplay__count__sum,
sum(BattlePassGetTaskReward__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as BattlePassGetTaskReward__count__sum,
sum(DeleteBatch__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as DeleteBatch__count__sum,
sum(LotteryHeroCardInfo__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as LotteryHeroCardInfo__count__sum,
sum(TradeStationGetInfo__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as TradeStationGetInfo__count__sum,
sum(UserAllianceLevelGetReward__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as UserAllianceLevelGetReward__count__sum,
sum(EliteNewSelfFightList__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as EliteNewSelfFightList__count__sum,
sum(ArenaUserFightRecordNew__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as ArenaUserFightRecordNew__count__sum,
sum(UserAlliancePointRank__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as UserAlliancePointRank__count__sum,
sum(SerialKillingBuyNum__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as SerialKillingBuyNum__count__sum,
sum(UserExpeditionWard__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as UserExpeditionWard__count__sum,
sum(ExchangeByActivity__num) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as ExchangeByActivity__num__sum,
sum(BattlePassGetDropExpInfo__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as BattlePassGetDropExpInfo__count__sum,
sum(DigHeroLevelUpPreview__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as DigHeroLevelUpPreview__count__sum,
sum(HeroQualityActGetReward__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as HeroQualityActGetReward__count__sum,
sum(ArenaGetInfo__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as ArenaGetInfo__count__sum,
sum(DigFoodCookCmd__number) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as DigFoodCookCmd__number__sum,
sum(UserAllianceDevelopView__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as UserAllianceDevelopView__count__sum,
sum(AlSiegeSetAlarm__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AlSiegeSetAlarm__count__sum,
sum(AddArmyImmediately__num) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AddArmyImmediately__num__sum,
sum(EquipUpHandler__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as EquipUpHandler__count__sum,
Pay__pay_PriceOfClosingCurrency,
sum(CrossPersonalRankInfo__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as CrossPersonalRankInfo__count__sum,
sum(LotteryRankShowReward__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as LotteryRankShowReward__count__sum,
sum(LocalPersonalRankReward__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as LocalPersonalRankReward__count__sum,
sum(AllianceAcceptInvite__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceAcceptInvite__count__sum,
sum(PVEOnHookRewardPreview__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as PVEOnHookRewardPreview__count__sum,
sum(AllianceRewardList__len) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceRewardList__len__sum,
sum(PlayerFormationChangeNameSave__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as PlayerFormationChangeNameSave__count__sum,
sum(GetNearBossPoint__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as GetNearBossPoint__count__sum,
sum(PayBeforeCheck__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as PayBeforeCheck__count__sum,
sum(AllianceMilitaryMeritRank__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceMilitaryMeritRank__count__sum,
sum(RadarCarIntelligenceReceive__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as RadarCarIntelligenceReceive__count__sum,
sum(RadarCarGetInfo__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as RadarCarGetInfo__count__sum,
sum(SyncHeroItemInfo__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as SyncHeroItemInfo__count__sum,
sum(AlSiegeStartTimeCancle__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AlSiegeStartTimeCancle__count__sum,
sum(AllianceSearchUser__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceSearchUser__count__sum,
sum(PVEClearanceLineupInfos__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as PVEClearanceLineupInfos__count__sum,
sum(ArenaGetRankList__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as ArenaGetRankList__count__sum,
sum(RandomWhirlSlotReward__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as RandomWhirlSlotReward__count__sum,
sum(MailReward__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as MailReward__count__sum,
sum(AllianceLogMemberView__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceLogMemberView__count__sum,
sum(UserAllianceDevelopRank__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as UserAllianceDevelopRank__count__sum,
sum(CureSoldier__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as CureSoldier__count__sum,
sum(HeroTrialReward__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as HeroTrialReward__count__sum,
sum(ServerTrendsInfo__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as ServerTrendsInfo__count__sum,
sum(AllianceComment__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceComment__count__sum,
sum(PreviewBuildingHeroEffectsInfo__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as PreviewBuildingHeroEffectsInfo__count__sum,
sum(UpgradeDirectly__goldCost) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as UpgradeDirectly__goldCost__sum,
sum(AllianceShowHelp__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceShowHelp__count__sum,
sum(ReadMail__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as ReadMail__count__sum,
sum(AlSiegeStartTimeSet__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AlSiegeStartTimeSet__count__sum,
sum(ZoneHonorRank__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as ZoneHonorRank__count__sum,
sum(AllianceSearch__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceSearch__count__sum,
sum(GarageFormationRepair__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as GarageFormationRepair__count__sum,
sum(DoomsdayBattlepassReceiveAllLevelReward__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as DoomsdayBattlepassReceiveAllLevelReward__count__sum,
sum(PVERankingHandler__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as PVERankingHandler__count__sum,
sum(BattlePassGetReward__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as BattlePassGetReward__count__sum,
sum(SeasonSettlementPackageViewOpen__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as SeasonSettlementPackageViewOpen__count__sum,
sum(AlSiegeWaveWorld__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AlSiegeWaveWorld__count__sum,
sum(SpeedQueueMultiple__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as SpeedQueueMultiple__count__sum,
sum(EliteNewStrongestRewardReview__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as EliteNewStrongestRewardReview__count__sum,
sum(SerialKillingRankInfo__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as SerialKillingRankInfo__count__sum,
sum(GetAllianceWorldCityInfo__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as GetAllianceWorldCityInfo__count__sum,
sum(PVEClearanceLineupDetailInfo__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as PVEClearanceLineupDetailInfo__count__sum,
sum(UserAllSkinInfo__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as UserAllSkinInfo__count__sum,
sum(AllianceShopUsrBuy__num) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceShopUsrBuy__num__sum,
sum(DoomsdayBattlepassReceiveLevelReward__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as DoomsdayBattlepassReceiveLevelReward__count__sum,
sum(DigHeroAdvancePreview__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as DigHeroAdvancePreview__count__sum,
sum(AllianceHelpAll__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceHelpAll__count__sum,
sum(GetActivityPanelInfo__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as GetActivityPanelInfo__count__sum,
sum(PVECheckpointArmyPreview__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as PVECheckpointArmyPreview__count__sum,
sum(EquipConsumeHandler__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as EquipConsumeHandler__count__sum,
sum(AllianceRewardAllreceive__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceRewardAllreceive__count__sum,
sum(AllianceShopShow__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceShopShow__count__sum,
sum(AllianceMemberRank__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceMemberRank__count__sum,
sum(TradeStationBuy__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as TradeStationBuy__count__sum,
sum(CheckNickName__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as CheckNickName__count__sum,
sum(BindingAccountHandler__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as BindingAccountHandler__count__sum,
sum(AllianceLeave__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceLeave__count__sum,
sum(AllianceShopAlBuy__num) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceShopAlBuy__num__sum,
sum(MarchLFFormation__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as MarchLFFormation__count__sum,
sum(RushModeHandler__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as RushModeHandler__count__sum,
sum(ArenaCalcFormationPower__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as ArenaCalcFormationPower__count__sum,
sum(ReceiveEventTask__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as ReceiveEventTask__count__sum,
sum(RankHandler__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as RankHandler__count__sum,
sum(AllianceShopRecycleShow__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceShopRecycleShow__count__sum,
sum(AllianceRewardReceive__count) over (partition by universal_user_id,platform,event_date order by event_date asc rows unbounded preceding) as AllianceRewardReceive__count__sum
from `xxxxx` 
