--This script calcualte the rolling_sum as of event_date for each event of each customer based on table_B which is the destination table in schedule_job_B. 
--Step 1: Change xxxxx in sql below to table_B. 
--Step 2: Run and validate the query in bigquery 
--Step 3: Create a schedule job(aka:schedule_job_C) to write the query  result to table_C.
select 
universal_user_id,
install_date,
event_date,
login_flag, 
pay_flag, 
login_music_state__flag,
sum(track_auth__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as track_auth__count__sum,
sum(wd_daryl_unlock_new_buildings__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as wd_daryl_unlock_new_buildings__count__sum,
sum(intel_v2__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as intel_v2__count__sum,
sum(daily_reward__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as daily_reward__count__sum,
sum(gold_event__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as gold_event__count__sum,
sum(se_battle__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as se_battle__count__sum,
sum(gather__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as gather__count__sum,
sum(custom_iap__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as custom_iap__count__sum,
sum(login_lord_gem__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as login_lord_gem__count__sum,
sum(month_card__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as month_card__count__sum,
sum(building_upgrade__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as building_upgrade__count__sum,
sum(CMS__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as CMS__count__sum,
sum(Halloween_Candy__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as Halloween_Candy__count__sum,
sum(lord_gem_verification_not_received__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as lord_gem_verification_not_received__count__sum,
sum(alliance_craft__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as alliance_craft__count__sum,
sum(score_special__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as score_special__count__sum,
sum(scout__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as scout__count__sum,
sum(teleport__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as teleport__count__sum,
sum(recharge_rebate__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as recharge_rebate__count__sum,
sum(gameLike__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as gameLike__count__sum,
sum(advance_research_upgrade__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as advance_research_upgrade__count__sum,
sum(festival_daily_task__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as festival_daily_task__count__sum,
sum(change_equipment__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as change_equipment__count__sum,
sum(ab_test__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as ab_test__count__sum,
sum(kingdom_war_pve__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as kingdom_war_pve__count__sum,
sum(wd_user_get_quest_reward__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as wd_user_get_quest_reward__count__sum,
sum(activity_festival_seven_days__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as activity_festival_seven_days__count__sum,
sum(iap_charge_continuous__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as iap_charge_continuous__count__sum,
sum(activity_plasma_scientific_prepare__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as activity_plasma_scientific_prepare__count__sum,
sum(questionnaire__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as questionnaire__count__sum,
sum(zombie_boss__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as zombie_boss__count__sum,
sum(remote_config__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as remote_config__count__sum,
sum(alliance_shop__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as alliance_shop__count__sum,
Stroy_Collect_Complete__flag,
sum(today_first_login__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as today_first_login__count__sum,
sum(activity_wd_seek__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as activity_wd_seek__count__sum,
sum(honor_pass_2__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as honor_pass_2__count__sum,
sum(train_troop_finish__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as train_troop_finish__count__sum,
sum(live_streaming__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as live_streaming__count__sum,
sum(timer_chest_gain__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as timer_chest_gain__count__sum,
sum(gold_event_season__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as gold_event_season__count__sum,
sum(building_upgrade_finish__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as building_upgrade_finish__count__sum,
sum(quest_complete__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as quest_complete__count__sum,
sum(chapter_quest_complete__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as chapter_quest_complete__count__sum,
sum(upgrade_clue__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as upgrade_clue__count__sum,
sum(dialog__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as dialog__count__sum,
sum(leave_alliance__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as leave_alliance__count__sum,
sum(survivor_support__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as survivor_support__count__sum,
sum(lord_level_up__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as lord_level_up__count__sum,
sum(localization_signin__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as localization_signin__count__sum,
sum(analysis_center_war__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as analysis_center_war__count__sum,
sum(go_back_claim_login_reward__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as go_back_claim_login_reward__count__sum,
sum(go_back_claim_free_iap__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as go_back_claim_free_iap__count__sum,
sum(halloween_event__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as halloween_event__count__sum,
sum(battle__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as battle__count__sum,
sum(disband_alliance__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as disband_alliance__count__sum,
sum(gain_reward__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as gain_reward__count__sum,
sum(combat__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as combat__count__sum,
sum(alliance_help__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as alliance_help__count__sum,
sum(vip__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as vip__count__sum,
sum(research_finish__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as research_finish__count__sum,
sum(login_lord_equipment__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as login_lord_equipment__count__sum,
sum(alliance_iap_gift__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as alliance_iap_gift__count__sum,
sum(buff_change__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as buff_change__count__sum,
sum(research_quest_complete__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as research_quest_complete__count__sum,
sum(battle_gather__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as battle_gather__count__sum,
sum(talent_skill__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as talent_skill__count__sum,
sum(chapter_group_start__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as chapter_group_start__count__sum,
sum(hidden_exploration__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as hidden_exploration__count__sum,
sum(battle_monster__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as battle_monster__count__sum,
sum(join_alliance__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as join_alliance__count__sum,
sum(world_line__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as world_line__count__sum,
sum(localization_exchange_event__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as localization_exchange_event__count__sum,
sum(prosperity__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as prosperity__count__sum,
sum(festival_region_pass__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as festival_region_pass__count__sum,
sum(alliance_tech__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as alliance_tech__count__sum,
sum(chapter_group_complete__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as chapter_group_complete__count__sum,
sum(go_back_sprint_quest_complete__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as go_back_sprint_quest_complete__count__sum,
sum(activity_advance_research_five_days__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as activity_advance_research_five_days__count__sum,
sum(alliance_request__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as alliance_request__count__sum,
sum(alliance_mark__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as alliance_mark__count__sum,
sum(explore_loading__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as explore_loading__count__sum,
sum(dress_up__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as dress_up__count__sum,
sum(exchange_code__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as exchange_code__count__sum,
sum(dismiss_troop__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as dismiss_troop__count__sum,
sum(go_back__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as go_back__count__sum,
sum(fresher_pease_shield__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as fresher_pease_shield__count__sum,
sum(user_agreement__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as user_agreement__count__sum,
sum(world_event_season_sign__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as world_event_season_sign__count__sum,
sum(week_card__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as week_card__count__sum,
sum(activity_survivor_seven_days__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as activity_survivor_seven_days__count__sum,
sum(supplememt_tropps_base__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as supplememt_tropps_base__count__sum,
sum(activity_red_packet__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as activity_red_packet__count__sum,
sum(battle_power_change__change_power) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as battle_power_change__change_power__sum,
sum(wd_daryl_get_reward__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as wd_daryl_get_reward__count__sum,
sum(avaleague_quest__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as avaleague_quest__count__sum,
sum(city_buff__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as city_buff__count__sum,
sum(big_timer_chest__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as big_timer_chest__count__sum,
sum(survivor_unlock__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as survivor_unlock__count__sum,
sum(custom_iap_2__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as custom_iap_2__count__sum,
sum(hero_drop__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as hero_drop__count__sum,
sum(tutorial_ex__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as tutorial_ex__count__sum,
sum(unlock_city_block_v3__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as unlock_city_block_v3__count__sum,
sum(exchange_survivor_chip__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as exchange_survivor_chip__count__sum,
sum(kingdom_war__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as kingdom_war__count__sum,
sum(plasma_building_prepare__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as plasma_building_prepare__count__sum,
sum(gameStoreScore__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as gameStoreScore__count__sum,
sum(growth_fund__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as growth_fund__count__sum,
sum(kvk__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as kvk__count__sum,
sum(wd_user_draw_real_reward__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as wd_user_draw_real_reward__count__sum,
sum(kvk_recuperate__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as kvk_recuperate__count__sum,
heal_troop__flag,
sum(donate__tot_times) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as donate__tot_times__sum,
sum(ask_alliance_help__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as ask_alliance_help__count__sum,
sum(view_other_city__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as view_other_city__count__sum,
sum(alliance_boss__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as alliance_boss__count__sum,
sum(survivor_search__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as survivor_search__count__sum,
sum(reward_center__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as reward_center__count__sum,
sum(alliance_donate_rank__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as alliance_donate_rank__count__sum,
sum(survivor__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as survivor__count__sum,
sum(user_vault__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as user_vault__count__sum,
sum(poison_land__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as poison_land__count__sum,
sum(battle_pvp_detail__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as battle_pvp_detail__count__sum,
sum(seven_day__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as seven_day__count__sum,
sum(chapter_quest_gain_quest_reward__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as chapter_quest_gain_quest_reward__count__sum,
sum(zombie_invasion__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as zombie_invasion__count__sum,
sum(exploration__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as exploration__count__sum,
sum(lord_equipment_gem_power__change_power) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as lord_equipment_gem_power__change_power__sum,
sum(IapPaymentSuccess__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as IapPaymentSuccess__count__sum,
sum(survivor_camp__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as survivor_camp__count__sum,
sum(hide_troop__hided_troops_power) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as hide_troop__hided_troops_power__sum,
sum(europe_policy__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as europe_policy__count__sum,
sum(micro_com__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as micro_com__count__sum,
sum(activity_daily_iap_accumulative_reward__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as activity_daily_iap_accumulative_reward__count__sum,
sum(powerup__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as powerup__count__sum,
sum(roguelike__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as roguelike__count__sum,
sum(claim_sprint_box_reward__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as claim_sprint_box_reward__count__sum,
sum(go_back_new_world__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as go_back_new_world__count__sum,
sum(unlock_city_block__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as unlock_city_block__count__sum,
sum(supplememt_tropps__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as supplememt_tropps__count__sum,
sum(loading__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as loading__count__sum,
sum(city_decoration__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as city_decoration__count__sum,
sum(stamina__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as stamina__count__sum,
sum(big_turntable__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as big_turntable__count__sum,
sum(wd_daryl_new_clue_gained__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as wd_daryl_new_clue_gained__count__sum,
sum(train_troop__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as train_troop__count__sum,
sum(story__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as story__count__sum,
research_upgrade__flag,
sum(alliance_speedup__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as alliance_speedup__count__sum,
sum(custom_iap_3__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as custom_iap_3__count__sum,
sum(shop__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as shop__count__sum,
sum(login__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as login__count__sum,
cheat_user__flag,
sum(kingdom_event__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as kingdom_event__count__sum,
sum(world_event__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as world_event__count__sum,
sum(quest_gain_reward__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as quest_gain_reward__count__sum,
sum(payment_submit_order__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as payment_submit_order__count__sum,
sum(chapter_quest_gain_group_reward__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as chapter_quest_gain_group_reward__count__sum,
sum(survivor_will__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as survivor_will__count__sum,
sum(forge_equipment__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as forge_equipment__count__sum,
sum(alliance_zone__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as alliance_zone__count__sum,
sum(survivor_summon__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as survivor_summon__count__sum,
city_fire__flag,
sum(buy_month_card__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as buy_month_card__count__sum,
sum(survivor_link__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as survivor_link__count__sum,
sum(create_alliance__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as create_alliance__count__sum,
sum(iap_exchange__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as iap_exchange__count__sum,
sum(super_exchange__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as super_exchange__count__sum,
sum(charge_first_pass__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as charge_first_pass__count__sum,
sum(switch_kingdom__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as switch_kingdom__count__sum,
sum(activity_gift__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as activity_gift__count__sum,
sum(tutorial__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as tutorial__count__sum,
sum(survivor_equipment__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as survivor_equipment__count__sum,
sum(npc_store__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as npc_store__count__sum,
sum(wd_user_answer_question__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as wd_user_answer_question__count__sum,
sum(alliance_mobilization__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as alliance_mobilization__count__sum,
sum(intelligence_stamina__change) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as intelligence_stamina__change__sum,
sum(dynamic_recommend_iap__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as dynamic_recommend_iap__count__sum,
sum(upgrade_troop__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as upgrade_troop__count__sum,
sum(MarchLine_Click__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as MarchLine_Click__count__sum,
login_survivor_equipment__flag,
sum(c__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as c__count__sum,
sum(fallen_knight__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as fallen_knight__count__sum,
sum(fallen_knight_defend_success__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as fallen_knight_defend_success__count__sum,
sum(battle_gve__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as battle_gve__count__sum,
sum(user_gem__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as user_gem__count__sum,
sum(puzzle_pve__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as puzzle_pve__count__sum,
sum(lord_equipment_power__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as lord_equipment_power__count__sum,
sum(hunter_house__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as hunter_house__count__sum,
sum(cultivate__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as cultivate__count__sum,
sum(plasma_cannon__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as plasma_cannon__count__sum,
sum(go_back_claim_sprint_quest_reward__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as go_back_claim_sprint_quest_reward__count__sum,
sum(storyline__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as storyline__count__sum,
sum(iap_trigger__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as iap_trigger__count__sum,
sum(wounded_reward__lost_power) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as wounded_reward__lost_power__sum,
sum(advance_research_finish__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as advance_research_finish__count__sum,
sum(go_back_user_info__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as go_back_user_info__count__sum,
sum(festival_pass__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as festival_pass__count__sum,
sum(wd_daryl_clue_compose__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as wd_daryl_clue_compose__count__sum,
sum(payment_pay_type__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as payment_pay_type__count__sum,
sum(user_skill__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as user_skill__count__sum,
sum(walking_dead_event__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as walking_dead_event__count__sum,
sum(mini_wonder_war__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as mini_wonder_war__count__sum,
sum(faq1_0__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as faq1_0__count__sum,
sum(buy_week_card__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as buy_week_card__count__sum,
sum(stronghold_level_reward__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as stronghold_level_reward__count__sum,
sum(world_event_memorial_book_abyss__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as world_event_memorial_book_abyss__count__sum,
sum(festival_wish__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as festival_wish__count__sum,
sum(festival_collection__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as festival_collection__count__sum,
focus_out__flag,
sum(MonthCard__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as MonthCard__count__sum,
focus_in__flag,
sum(activity_limit_time_discount_shop__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as activity_limit_time_discount_shop__count__sum,
sum(micro_com1_1__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as micro_com1_1__count__sum,
sum(go_back_claim_sprint_task_reward__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as go_back_claim_sprint_task_reward__count__sum,
sum(march__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as march__count__sum,
sum(transaction__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as transaction__count__sum,
sum(festival_boss__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as festival_boss__count__sum,
sum(wd_collection__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as wd_collection__count__sum,
sum(avaleague__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as avaleague__count__sum,
sum(avaleague_guess__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as avaleague_guess__count__sum,
sum(exchange_gifts__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as exchange_gifts__count__sum,
auto_fix_date__flag,
sum(festival_navigation__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as festival_navigation__count__sum,
sum(lord_gem_verification_attack_boss_finish__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as lord_gem_verification_attack_boss_finish__count__sum,
sum(open_fallen_knight__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as open_fallen_knight__count__sum,
sum(lord_gem_verification_quest_complete__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as lord_gem_verification_quest_complete__count__sum,
sum(action__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as action__count__sum,
sum(anti_addiction__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as anti_addiction__count__sum,
sum(climbing_tower__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as climbing_tower__count__sum,
sum(festival_story__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as festival_story__count__sum,
sum(new_big_turntable__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as new_big_turntable__count__sum,
sum(festival_zodiac_collect__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as festival_zodiac_collect__count__sum,
sum(startDailyQuestBI__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as startDailyQuestBI__count__sum,
sum(lord_gem_verification_attack_boss_start__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as lord_gem_verification_attack_boss_start__count__sum,
sum(lord_gem_verification_combat_ready_receive__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as lord_gem_verification_combat_ready_receive__count__sum,
sum(abyss__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as abyss__count__sum,
sum(honor_pass__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as honor_pass__count__sum,
sum(hero_flip_card_over__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as hero_flip_card_over__count__sum,
launch_start__flag,
sum(lord_gem_verification_quest_receive__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as lord_gem_verification_quest_receive__count__sum,
sum(activity_festival_equip_seven_days__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as activity_festival_equip_seven_days__count__sum,
sum(lord_gem_verification_rank__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as lord_gem_verification_rank__count__sum,
sum(world_open__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as world_open__count__sum,
sum(season_climb_tower__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as season_climb_tower__count__sum,
sum(treasure_discover__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as treasure_discover__count__sum,
sum(noteBookWithoutAlliance__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as noteBookWithoutAlliance__count__sum,
sum(throne_shock_relocation__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as throne_shock_relocation__count__sum,
sum(lord_gem_verification_buff_change__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as lord_gem_verification_buff_change__count__sum,
sum(friend_list_option__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as friend_list_option__count__sum,
sum(festival_pass_2__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as festival_pass_2__count__sum,
sum(submitDailyQuestBI__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as submitDailyQuestBI__count__sum,
sum(exchange_event__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as exchange_event__count__sum,
sum(invite_new_user__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as invite_new_user__count__sum,
sum(start_gather_march__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as start_gather_march__count__sum,
sum(activity_recycle__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as activity_recycle__count__sum,
sum(achievement__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as achievement__count__sum,
sum(session_start__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as session_start__count__sum,
sum(dialog_skip__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as dialog_skip__count__sum,
sum(lord_gem_verification_ready_open__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as lord_gem_verification_ready_open__count__sum,
sum(lord_gem_verification_score_quest_complete__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as lord_gem_verification_score_quest_complete__count__sum,
sum(world_event_memorial_book_kvk__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as world_event_memorial_book_kvk__count__sum,
sum(equipment_signin__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as equipment_signin__count__sum,
sum(daily_sign_in__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as daily_sign_in__count__sum,
sum(ava__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as ava__count__sum,
sum(session_en__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as session_en__count__sum,
sum(super_exchange_2__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as super_exchange_2__count__sum,
sum(wd_lottery__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as wd_lottery__count__sum,
sum(service_monitoring__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as service_monitoring__count__sum,
sum(alliance_trade__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as alliance_trade__count__sum,
sum(activity_drop__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as activity_drop__count__sum,
sum(session_end__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as session_end__count__sum,
sum(lord_gem_verification_ready_score_change__count) over (partition by universal_user_id,event_date order by event_date asc rows unbounded preceding) as lord_gem_verification_ready_score_change__count__sum,
event_SS_Revenue__value_in_usd,
first_open__flag
from `xxxxx` 
order by universal_user_id, event_date 
